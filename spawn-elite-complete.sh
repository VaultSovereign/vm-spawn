#!/usr/bin/env bash
# spawn-elite-complete.sh - COMPLETE Elite Spawn (base + elite features)
set -euo pipefail

REPO_NAME="${1:-}"
REPO_TYPE="${2:-service}"
REPO_BASE="${VAULTMESH_REPOS:-$HOME/repos}"

if [[ -z "$REPO_NAME" ]]; then
  echo "Usage: spawn-elite-complete.sh <name> [type]"
  echo "Example: spawn-elite-complete.sh payment-service service"
  exit 1
fi

# Step 1: Run base spawn
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸš€ STEP 1: Creating base repository..."
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
./spawn-linux.sh "$REPO_NAME" "$REPO_TYPE"

# Step 2: Add elite features
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ”¥ STEP 2: Adding ELITE features..."
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
./add-elite-features.sh "$REPO_BASE/$REPO_NAME"

# Done!
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ‰ ELITE REPOSITORY COMPLETE!"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "Location: $REPO_BASE/$REPO_NAME"
echo ""
echo "What you got:"
echo "  âœ… Complete base repository (FastAPI/tests/docs)"
echo "  âœ… GitHub Actions CI/CD"
echo "  âœ… Kubernetes manifests + HPA"
echo "  âœ… Docker Compose + monitoring stack"
echo "  âœ… Prometheus + Grafana configs"
echo "  âœ… Elite multi-stage Dockerfile"
echo ""
echo "Next steps:"
echo "  cd $REPO_BASE/$REPO_NAME"
echo "  make dev                  # Start development"
echo "  docker-compose up -d      # Full stack with monitoring"
echo "  make test                 # Run tests"
echo ""
